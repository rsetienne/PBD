<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Bootstrap analysis under protracted birth-death model of diversification — pbd_bootstrap • PBD</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Bootstrap analysis under protracted birth-death model of diversification — pbd_bootstrap"><meta property="og:description" content="Likelihood maximization for protracted birth-death model of diversification
followed by simulations of the model using the maximum likelihood parameter
estimates to compute an estimate of the error in these estimates and to
assess the goodness-of-fit of the model by comparing maximum likelihoods of
the simulated data sets to the maximum likelihood of the real data set."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PBD</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/PBD_ML_demo.html">pbd_ML demo</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bootstrap analysis under protracted birth-death model of diversification</h1>

    <div class="hidden name"><code>pbd_bootstrap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Likelihood maximization for protracted birth-death model of diversification
followed by simulations of the model using the maximum likelihood parameter
estimates to compute an estimate of the error in these estimates and to
assess the goodness-of-fit of the model by comparing maximum likelihoods of
the simulated data sets to the maximum likelihood of the real data set.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pbd_bootstrap</span><span class="op">(</span></span>
<span>  <span class="va">brts</span>,</span>
<span>  initparsopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  idparsopt <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">initparsopt</span><span class="op">)</span>,</span>
<span>  idparsfix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parsfix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exteq <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">initparsopt</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>  parsfunc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">pars</span><span class="op">)</span> <span class="op">{</span>     <span class="va">pars</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">}</span>, <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">pars</span><span class="op">)</span> <span class="op">{</span>     <span class="va">pars</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">}</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">pars</span><span class="op">)</span> <span class="op">{</span>     <span class="va">pars</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">}</span>, <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">pars</span><span class="op">)</span> <span class="op">{</span>     <span class="va">pars</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">}</span><span class="op">)</span>,</span>
<span>  missnumspec <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cond <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  btorph <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  soc <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  plotltt <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  methode <span class="op">=</span> <span class="st">"lsoda"</span>,</span>
<span>  n_low <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  n_up <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-04</span>, <span class="fl">1e-04</span>, <span class="fl">1e-06</span><span class="op">)</span>,</span>
<span>  maxiter <span class="op">=</span> <span class="fl">1000</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1.25</span><span class="op">)</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">idparsopt</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  endmc <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span>,</span>
<span>  optimmethod <span class="op">=</span> <span class="st">"subplex"</span>,</span>
<span>  num_cycles <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-brts">brts<a class="anchor" aria-label="anchor" href="#arg-brts"></a></dt>
<dd><p>A set of branching times of a phylogeny, all positive</p></dd>


<dt id="arg-initparsopt">initparsopt<a class="anchor" aria-label="anchor" href="#arg-initparsopt"></a></dt>
<dd><p>The initial values of the parameters that must be
optimized</p></dd>


<dt id="arg-idparsopt">idparsopt<a class="anchor" aria-label="anchor" href="#arg-idparsopt"></a></dt>
<dd><p>The ids of the parameters that must be optimized, e.g. 1:4
for all parameters.  The ids are defined as follows: <br> id == 1 corresponds
to b (speciation-initiation rate) <br> id == 2 corresponds to mu_1
(extinction rate of good species) <br> id == 3 corresponds to la_1
(speciation-completion rate) <br> id == 4 corresponds to mu_2 (extinction
rate of incipient species) <br></p></dd>


<dt id="arg-idparsfix">idparsfix<a class="anchor" aria-label="anchor" href="#arg-idparsfix"></a></dt>
<dd><p>The ids of the parameters that should not be optimized,
e.g. c(2,4) if mu_1 and mu_2 should not be optimized, but only b and la_1.
In that case idparsopt must be c(1,3).</p></dd>


<dt id="arg-parsfix">parsfix<a class="anchor" aria-label="anchor" href="#arg-parsfix"></a></dt>
<dd><p>The values of the parameters that should not be optimized</p></dd>


<dt id="arg-exteq">exteq<a class="anchor" aria-label="anchor" href="#arg-exteq"></a></dt>
<dd><p>Sets whether incipient species have the same (1) or different
(0) extinction rate as good species. If exteq = 0, then idparsfix and
idparsopt should together have all parameters 1:4</p></dd>


<dt id="arg-parsfunc">parsfunc<a class="anchor" aria-label="anchor" href="#arg-parsfunc"></a></dt>
<dd><p>Specifies functions how the rates depend on time, default
functions are constant functions</p></dd>


<dt id="arg-missnumspec">missnumspec<a class="anchor" aria-label="anchor" href="#arg-missnumspec"></a></dt>
<dd><p>The number of species that are in the clade but missing
in the phylogeny</p></dd>


<dt id="arg-cond">cond<a class="anchor" aria-label="anchor" href="#arg-cond"></a></dt>
<dd><p>Conditioning: <br> cond == 0 : conditioning on stem or crown age
<br> cond == 1 : conditioning on stem or crown age and non-extinction of the
phylogeny <br></p></dd>


<dt id="arg-btorph">btorph<a class="anchor" aria-label="anchor" href="#arg-btorph"></a></dt>
<dd><p>Sets whether the likelihood is for the branching times (0) or
the phylogeny (1)</p></dd>


<dt id="arg-soc">soc<a class="anchor" aria-label="anchor" href="#arg-soc"></a></dt>
<dd><p>Sets whether the first element of the branching times is the stem
(1) or the crown (2) age</p></dd>


<dt id="arg-plotltt">plotltt<a class="anchor" aria-label="anchor" href="#arg-plotltt"></a></dt>
<dd><p>Sets whether the lineage-through-time plot should be plotted
(1) or not (0)</p></dd>


<dt id="arg-methode">methode<a class="anchor" aria-label="anchor" href="#arg-methode"></a></dt>
<dd><p>Sets which method should be used in the ode-solver. Default
is 'lsoda'. See package deSolve for details.</p></dd>


<dt id="arg-n-low">n_low<a class="anchor" aria-label="anchor" href="#arg-n-low"></a></dt>
<dd><p>Sets the lower bound of the number of species on which
conditioning should be done when cond = 2. Set this to 0 when conditioning
should be done on precisely the number of species (default)</p></dd>


<dt id="arg-n-up">n_up<a class="anchor" aria-label="anchor" href="#arg-n-up"></a></dt>
<dd><p>Sets the upper bound of the number of species on which
conditioning should be done when cond = 2. Set this to 0 when conditioning
should be done on precisely the number of species (default)</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Sets the tolerances in the optimization. Consists of: <br> reltolx
= relative tolerance of parameter values in optimization <br> reltolf =
relative tolerance of function value in optimization <br> abstolx = absolute
tolerance of parameter values in optimization</p></dd>


<dt id="arg-maxiter">maxiter<a class="anchor" aria-label="anchor" href="#arg-maxiter"></a></dt>
<dd><p>Sets the maximum number of iterations in the optimization</p></dd>


<dt id="arg-endmc">endmc<a class="anchor" aria-label="anchor" href="#arg-endmc"></a></dt>
<dd><p>Sets the number of simulations for the bootstrap</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Sets the seed for the simulations of the bootstrap</p></dd>


<dt id="arg-optimmethod">optimmethod<a class="anchor" aria-label="anchor" href="#arg-optimmethod"></a></dt>
<dd><p>Method used in optimization of the likelihood. Current
default is 'subplex'. Alternative is 'simplex' (default of previous
versions)</p></dd>


<dt id="arg-num-cycles">num_cycles<a class="anchor" aria-label="anchor" href="#arg-num-cycles"></a></dt>
<dd><p>Number of cycles of the optimization (default is 1).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>if TRUE, explanatory text will be shown</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of three dataframes. The first dataframe contains the maximum
likelihood results of the real data set, the second contains the simulated
trees, and the third dataframe, with number of rows equal to endmc, contain
the maximum likelihood results for the simulated data. The columns of both
frames contains the following elements for each simulated data set:</p>
<dl><dt>ntips</dt>
<dd><p>gives the number of tips</p></dd>

<dt>b</dt>
<dd><p>gives the maximum likelihood estimate of b</p></dd>

<dt>mu_1</dt>
<dd><p>gives the maximum likelihood estimate
of mu_1</p></dd>

<dt>la_1</dt>
<dd><p>gives the maximum likelihood estimate of la_1</p></dd>

<dt>mu_2</dt>
<dd><p>gives the maximum likelihood estimate of mu_2</p></dd>

<dt>loglik</dt>
<dd><p>gives the maximum loglikelihood</p></dd>

<dt>df</dt>
<dd><p>gives the number of estimated parameters, i.e. degrees of feedom</p></dd>

<dt>conv</dt>
<dd><p>gives a message on convergence of optimization; conv = 0 means
convergence</p></dd>

<dt>exp_durspec</dt>
<dd><p>gives the expected duration of speciation</p></dd>

<dt>median_durspec</dt>
<dd><p>gives the median duration of speciation</p></dd>

</dl></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="pbd_ML.html">pbd_ML</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Rampal S. Etienne</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rampal S. Etienne.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

